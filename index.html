<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ©ã‚¤ã‚ªãƒ³ã‚²ãƒ¼ãƒ </title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
            background: #f1f1f1;
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.55.2/phaser.min.js"></script>
    <script>
        // ã‚²ãƒ¼ãƒ ã®åŸºæœ¬è¨­å®š
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 300 },
                    debug: false
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        const game = new Phaser.Game(config);

        let animals;
        let nextAnimal;
        let score = 0;
        let scoreText;

        // ã‚²ãƒ¼ãƒ ã®è¨­å®š
        const animalTypes = ['ğŸ§', 'ğŸ¬', 'ğŸ¼', 'ğŸ¯', 'ğŸ¦'];
        const animalSizes = {
            'ğŸ§': 20,  // ğŸ§ãŒæœ€ã‚‚å°ã•ã„
            'ğŸ¬': 30,
            'ğŸ¼': 40,
            'ğŸ¯': 50,
            'ğŸ¦': 60  // ğŸ¦ãŒæœ€ã‚‚å¤§ãã„
        };

        function preload() {
            // ç”»åƒã®ãƒ­ãƒ¼ãƒ‰ï¼ˆä»Šå›ã¯ç”»åƒã‚’ä½¿ã‚ãšã€çµµæ–‡å­—ã‚’ä½¿ç”¨ï¼‰
        }

        function create() {
            // ç‰©ç†ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆ
            animals = this.physics.add.group();

            // ã‚¹ã‚³ã‚¢ãƒ†ã‚­ã‚¹ãƒˆã®ä½œæˆ
            scoreText = this.add.text(16, 16, 'ã‚¹ã‚³ã‚¢: 0', { fontSize: '32px', fill: '#000' });

            // æ¬¡ã®å‹•ç‰©ã‚’ç”Ÿæˆ
            createNextAnimal();
        }

        function update() {
            // ãƒã‚¦ã‚¹ã¾ãŸã¯ã‚¿ãƒƒãƒã§å‹•ç‰©ã‚’è½ã¨ã™
            if (this.input.activePointer.isDown) {
                dropAnimal();
            }

            // å‹•ç‰©åŒå£«ã®è¡çªã‚’ãƒã‚§ãƒƒã‚¯
            this.physics.add.collider(animals, animals, animalCollision, null, this);
        }

        function createNextAnimal() {
            // ãƒ©ãƒ³ãƒ€ãƒ ãªå‹•ç‰©ã‚’ç”Ÿæˆ
            nextAnimal = Phaser.Math.RND.pick(animalTypes);
        }

        function dropAnimal() {
            // å‹•ç‰©ã‚’è½ã¨ã™
            const x = this.input.activePointer.x;
            const y = 0;  // è½ã¡ã‚‹ä½ç½®
            const animal = animals.create(x, y, nextAnimal);
            animal.setCollideWorldBounds(true);  // ç”»é¢å¤–ã«å‡ºãªã„ã‚ˆã†ã«ã™ã‚‹
            animal.setBounce(0.8);  // åç™ºåŠ›ã‚’è¨­å®š
            animal.setVelocity(0, 200);  // è½ä¸‹é€Ÿåº¦ã‚’è¨­å®š
            createNextAnimal();  // æ¬¡ã®å‹•ç‰©ã‚’ç”Ÿæˆ
        }

        function animalCollision(animal1, animal2) {
            // åŒã˜ç¨®é¡ã®å‹•ç‰©ãŒè¡çªã—ãŸå ´åˆ
            if (animal1.texture.key === animal2.texture.key) {
                // å‹•ç‰©ã‚’é€²åŒ–ã•ã›ã‚‹
                evolveAnimal(animal1);
                evolveAnimal(animal2);

                // ã‚¹ã‚³ã‚¢ã‚’æ›´æ–°
                updateScore();
            }
        }

        function evolveAnimal(animal) {
            // å‹•ç‰©ã‚’é€²åŒ–ã•ã›ã‚‹
            const currentAnimal = animal.texture.key;
            const evolutionOrder = {
                'ğŸ§': 'ğŸ¬',
                'ğŸ¬': 'ğŸ¼',
                'ğŸ¼': 'ğŸ¯',
                'ğŸ¯': 'ğŸ¦'
            };

            if (evolutionOrder[currentAnimal]) {
                // é€²åŒ–ã—ãŸå‹•ç‰©ã‚’è¨­å®š
                animal.setTexture(evolutionOrder[currentAnimal]);
                animal.setScale(animalSizes[evolutionOrder[currentAnimal]] / animalSizes[currentAnimal]);  // ã‚µã‚¤ã‚ºã‚’å¤‰æ›´
            }
        }

        function updateScore() {
            score += 10;
            scoreText.setText('ã‚¹ã‚³ã‚¢: ' + score);
        }
    </script>
</body>
</html>
